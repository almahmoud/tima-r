<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="timaR">
<title>2 Formatting all inputs • timaR</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.1.0/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.1.0/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.rawgit.com/afeld/bootstrap-toc/v1.0.1/dist/bootstrap-toc.min.js"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="2 Formatting all inputs">
<meta property="og:description" content="timaR">
<meta property="og:image" content="https://taxonomicallyinformedannotation.github.io/tima-r/reference/figures/logo.png">
<meta property="og:image:alt" content="Taxonomically Informed Metabolite Annotation">
<meta name="twitter:card" content="summary">
<meta name="twitter:creator" content="@adafede">
<meta name="twitter:site" content="@adafede">
<meta name="google-site-verification" content="Bt77rpBuC_R-0p62TWtA_ba5rvx-PuSEMv4LHg1UsOo">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">timaR</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">2.2.2</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="active nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/0-intro.html">0 General comments about the infrastructure</a>
    <a class="dropdown-item" href="../articles/1-library.html">1 Preparing your structure-organism pairs library</a>
    <a class="dropdown-item" href="../articles/2-formatting.html">2 Formatting all inputs</a>
    <a class="dropdown-item" href="../articles/3-processing.html">3 Performing Taxonomically Informed Metabolite Annotation</a>
    <a class="dropdown-item" href="../articles/4-actual-performance.html">4 Actual Performance</a>
  </div>
</li>
<li class="nav-item">
  <a class="nav-link" href="../news/index.html">Changelog</a>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav">
<li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/taxonomicallyinformedannotation/tima-r/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>

    
  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>2 Formatting all inputs</h1>
                        <h4 data-toc-skip class="author">Adriano Rutz</h4>
            
            <h4 data-toc-skip class="date">2022-01-25</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/taxonomicallyinformedannotation/tima-r/blob/HEAD/vignettes/2-formatting.Rmd" class="external-link"><code>vignettes/2-formatting.Rmd</code></a></small>
      <div class="d-none name"><code>2-formatting.Rmd</code></div>
    </div>

    
    
<p>This vignette describes how to format all your files.</p>
<div class="section level2">
<h2 id="structural-annotations-of-your-features">Structural annotations of your features<a class="anchor" aria-label="anchor" href="#structural-annotations-of-your-features"></a>
</h2>
<p>For the moment, we support annotations coming from 3 different annotation tools: <a href="https://gnps.ucsd.edu" class="external-link">GNPS</a>, <a href="https://bio.informatik.uni-jena.de/software/sirius" class="external-link">SIRIUS</a> and our <em>in lab</em> developed tool, <strong><a href="https://github.com/mandelbrot-project/spectral_lib_matcher" class="external-link">ISDB</a></strong>. We hope to soon implement SIRIUS support.</p>
<p>In order to perform MS2 annotation based on an <strong>I</strong>n <strong>S</strong>ilico <strong>D</strong>ata<strong>B</strong>ase, please follow the following repository: <a href="https://github.com/mandelbrot-project/spectral_lib_matcher" class="external-link">spectral_lib_matcher</a></p>
<p>For Sirius and GNPS, please follow their own documentation.</p>
<div class="section level3">
<h3 id="get-an-example">Get an example<a class="anchor" aria-label="anchor" href="#get-an-example"></a>
</h3>
<div class="section level4">
<h4 id="isdb">ISDB<a class="anchor" aria-label="anchor" href="#isdb"></a>
</h4>
<p>As <a href="https://github.com/mandelbrot-project/spectral_lib_matcher" class="external-link">spectral_lib_matcher</a> is only in python, for the moment, we provide an example output coming from the new ISDB. We are working on a better integration. As this comes by default, you do not need to modify any parameters</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="st"><a href="https://github.com/taxonomicallyinformedannotation/tima-r" class="external-link">"timaR"</a></span><span class="op">)</span></code></pre></div>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/source.html" class="external-link">source</a></span><span class="op">(</span>file <span class="op">=</span> <span class="st">"inst/scripts/get_example_isdb.R"</span><span class="op">)</span>
<span class="co">#&gt; 2022-01-25 12:12:00 This script <span style="color: #00BB00;">downloads an example of spectral_lib_matcher (ISDB) output. </span></span>
<span class="co"><span style="color: #00BB00;">#&gt; </span> </span>
<span class="co">#&gt; 2022-01-25 12:12:00 Authors:  <span style="color: #00BB00;">AR</span> </span>
<span class="co">#&gt;  </span>
<span class="co">#&gt; 2022-01-25 12:12:00 Contributors: ... </span>
<span class="co">#&gt; 2022-01-25 12:12:00 Loading paths</span>
<span class="co">#&gt; <span style="font-weight: bold;">Rows: </span><span style="color: #0000BB;">141495</span> <span style="font-weight: bold;">Columns: </span><span style="color: #0000BB;">7</span></span>
<span class="co">#&gt; <span style="color: #00BBBB;">──</span> <span style="font-weight: bold;">Column specification</span> <span style="color: #00BBBB;">────────────────────────────────────────────────────────</span></span>
<span class="co">#&gt; <span style="font-weight: bold;">Delimiter:</span> "\t"</span>
<span class="co">#&gt; <span style="color: #BB0000;">chr</span> (3): short_inchikey, smiles, molecular_formula</span>
<span class="co">#&gt; <span style="color: #00BB00;">dbl</span> (4): msms_score, matched_peaks, feature_id, exact_mass</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> Use <span style="color: #262626; background-color: #DADADA;">`spec()`</span> to retrieve the full column specification for this data.</span>
<span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> Specify the column types or set <span style="color: #262626; background-color: #DADADA;">`show_col_types = FALSE`</span> to quiet this message.</span>
<span class="co">#&gt; 2022-01-25 12:12:03 Script finished in <span style="color: #00BB00;">3.534539 secs</span></span></code></pre></div>
</div>
<div class="section level4">
<h4 id="sirius">SIRIUS<a class="anchor" aria-label="anchor" href="#sirius"></a>
</h4>
<p>As, given its size, it is not easy to share a complete SIRIUS job, we prepared an example containing only summary files. We also generated the npc classes as in <a href="https://github.com/kaibioinfo/canopus_treemap" class="external-link uri">https://github.com/kaibioinfo/canopus_treemap</a>. They have to be stored in the same folder under the name ‘canopus_npc_summary.csv’.</p>
<p>You can get the example running:</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/source.html" class="external-link">source</a></span><span class="op">(</span>file <span class="op">=</span> <span class="st">"inst/scripts/get_example_sirius.R"</span><span class="op">)</span>
<span class="co">#&gt; 2022-01-25 12:12:03 This script <span style="color: #00BB00;">downloads an example of SIRIUS output. </span></span>
<span class="co"><span style="color: #00BB00;">#&gt; </span> </span>
<span class="co">#&gt; 2022-01-25 12:12:03 Authors:  <span style="color: #00BB00;">AR</span> </span>
<span class="co">#&gt;  </span>
<span class="co">#&gt; 2022-01-25 12:12:03 Contributors: ... </span>
<span class="co">#&gt; 2022-01-25 12:12:03 Loading paths</span>
<span class="co">#&gt; <span style="font-weight: bold;">Rows: </span><span style="color: #0000BB;">5563</span> <span style="font-weight: bold;">Columns: </span><span style="color: #0000BB;">10</span></span>
<span class="co">#&gt; <span style="color: #00BBBB;">──</span> <span style="font-weight: bold;">Column specification</span> <span style="color: #00BBBB;">────────────────────────────────────────────────────────</span></span>
<span class="co">#&gt; <span style="font-weight: bold;">Delimiter:</span> ","</span>
<span class="co">#&gt; <span style="color: #BB0000;">chr</span> (6): name, directoryName, pathway, superclass, class, ClassyFirePrediction</span>
<span class="co">#&gt; <span style="color: #00BB00;">dbl</span> (4): pathwayProbability, superclassProbability, classProbability, Classy...</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> Use <span style="color: #262626; background-color: #DADADA;">`spec()`</span> to retrieve the full column specification for this data.</span>
<span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> Specify the column types or set <span style="color: #262626; background-color: #DADADA;">`show_col_types = FALSE`</span> to quiet this message.</span>
<span class="co">#&gt; <span style="font-weight: bold;">Rows: </span><span style="color: #0000BB;">10408</span> <span style="font-weight: bold;">Columns: </span><span style="color: #0000BB;">10</span></span>
<span class="co">#&gt; <span style="color: #00BBBB;">──</span> <span style="font-weight: bold;">Column specification</span> <span style="color: #00BBBB;">────────────────────────────────────────────────────────</span></span>
<span class="co">#&gt; <span style="font-weight: bold;">Delimiter:</span> "\t"</span>
<span class="co">#&gt; <span style="color: #BB0000;">chr</span> (10): name, molecularFormula, adduct, precursorFormula, most specific cl...</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> Use <span style="color: #262626; background-color: #DADADA;">`spec()`</span> to retrieve the full column specification for this data.</span>
<span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> Specify the column types or set <span style="color: #262626; background-color: #DADADA;">`show_col_types = FALSE`</span> to quiet this message.</span>
<span class="co">#&gt; <span style="font-weight: bold;">Rows: </span><span style="color: #0000BB;">5735</span> <span style="font-weight: bold;">Columns: </span><span style="color: #0000BB;">21</span></span>
<span class="co">#&gt; <span style="color: #00BBBB;">──</span> <span style="font-weight: bold;">Column specification</span> <span style="color: #00BBBB;">────────────────────────────────────────────────────────</span></span>
<span class="co">#&gt; <span style="font-weight: bold;">Delimiter:</span> "\t"</span>
<span class="co">#&gt; <span style="color: #BB0000;">chr</span> (10): ConfidenceScore, molecularFormula, adduct, InChIkey2D, InChI, name...</span>
<span class="co">#&gt; <span style="color: #00BB00;">dbl</span> (11): rank, formulaRank, #adducts, #predictedFPs, CSI:FingerIDScore, Zod...</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> Use <span style="color: #262626; background-color: #DADADA;">`spec()`</span> to retrieve the full column specification for this data.</span>
<span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> Specify the column types or set <span style="color: #262626; background-color: #DADADA;">`show_col_types = FALSE`</span> to quiet this message.</span>
<span class="co">#&gt; <span style="font-weight: bold;">Rows: </span><span style="color: #0000BB;">8256</span> <span style="font-weight: bold;">Columns: </span><span style="color: #0000BB;">21</span></span>
<span class="co">#&gt; <span style="color: #00BBBB;">──</span> <span style="font-weight: bold;">Column specification</span> <span style="color: #00BBBB;">────────────────────────────────────────────────────────</span></span>
<span class="co">#&gt; <span style="font-weight: bold;">Delimiter:</span> "\t"</span>
<span class="co">#&gt; <span style="color: #BB0000;">chr</span> (10): ConfidenceScore, molecularFormula, adduct, InChIkey2D, InChI, name...</span>
<span class="co">#&gt; <span style="color: #00BB00;">dbl</span> (11): rank, formulaRank, #adducts, #predictedFPs, CSI:FingerIDScore, Zod...</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> Use <span style="color: #262626; background-color: #DADADA;">`spec()`</span> to retrieve the full column specification for this data.</span>
<span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> Specify the column types or set <span style="color: #262626; background-color: #DADADA;">`show_col_types = FALSE`</span> to quiet this message.</span>
<span class="co">#&gt; <span style="font-weight: bold;">Rows: </span><span style="color: #0000BB;">6514</span> <span style="font-weight: bold;">Columns: </span><span style="color: #0000BB;">16</span></span>
<span class="co">#&gt; <span style="color: #00BBBB;">──</span> <span style="font-weight: bold;">Column specification</span> <span style="color: #00BBBB;">────────────────────────────────────────────────────────</span></span>
<span class="co">#&gt; <span style="font-weight: bold;">Delimiter:</span> "\t"</span>
<span class="co">#&gt; <span style="color: #BB0000;">chr</span>  (4): molecularFormula, adduct, precursorFormula, id</span>
<span class="co">#&gt; <span style="color: #00BB00;">dbl</span> (12): rank, ZodiacScore, SiriusScore, TreeScore, IsotopeScore, numExplai...</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> Use <span style="color: #262626; background-color: #DADADA;">`spec()`</span> to retrieve the full column specification for this data.</span>
<span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> Specify the column types or set <span style="color: #262626; background-color: #DADADA;">`show_col_types = FALSE`</span> to quiet this message.</span>
<span class="co">#&gt; <span style="font-weight: bold;">Rows: </span><span style="color: #0000BB;">8533</span> <span style="font-weight: bold;">Columns: </span><span style="color: #0000BB;">16</span></span>
<span class="co">#&gt; <span style="color: #00BBBB;">──</span> <span style="font-weight: bold;">Column specification</span> <span style="color: #00BBBB;">────────────────────────────────────────────────────────</span></span>
<span class="co">#&gt; <span style="font-weight: bold;">Delimiter:</span> "\t"</span>
<span class="co">#&gt; <span style="color: #BB0000;">chr</span>  (4): molecularFormula, adduct, precursorFormula, id</span>
<span class="co">#&gt; <span style="color: #00BB00;">dbl</span> (12): rank, ZodiacScore, SiriusScore, TreeScore, IsotopeScore, numExplai...</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> Use <span style="color: #262626; background-color: #DADADA;">`spec()`</span> to retrieve the full column specification for this data.</span>
<span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> Specify the column types or set <span style="color: #262626; background-color: #DADADA;">`show_col_types = FALSE`</span> to quiet this message.</span>
<span class="co">#&gt; 2022-01-25 12:12:15 Script finished in <span style="color: #00BB00;">11.62559 secs</span></span></code></pre></div>
</div>
<div class="section level4">
<h4 id="gnps">GNPS<a class="anchor" aria-label="anchor" href="#gnps"></a>
</h4>
<p>We also provide an example GNPS job id, which is: <code>96fa7c88200e4a03bee4644e581e3fb0</code></p>
</div>
</div>
<div class="section level3">
<h3 id="formatting">Formatting<a class="anchor" aria-label="anchor" href="#formatting"></a>
</h3>
<p>Before running the corresponding code, do not forget to modify <code>config/params/prepare_*yourAnnotationTool*.yaml</code>.</p>
<p>Depending on the annotation tool you used, you can format its results using:</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/source.html" class="external-link">source</a></span><span class="op">(</span>file <span class="op">=</span> <span class="st">"inst/scripts/prepare_gnps.R"</span><span class="op">)</span>
<span class="co">#&gt; 2022-01-25 12:12:15 This script <span style="color: #00BB00;">formats GNPS (and NAP) results</span> </span>
<span class="co">#&gt; 2022-01-25 12:12:15 Authors:  <span style="color: #00BB00;">AR</span> </span>
<span class="co">#&gt;  </span>
<span class="co">#&gt; 2022-01-25 12:12:15 Contributors: ... </span>
<span class="co">#&gt; 2022-01-25 12:12:15 Loading paths </span>
<span class="co">#&gt; 2022-01-25 12:12:15 Loading yaml parameters </span>
<span class="co">#&gt; 2022-01-25 12:12:15 Loading command line arguments </span>
<span class="co">#&gt; 2022-01-25 12:12:15 Loading and formatting GNPS results</span>
<span class="co">#&gt; <span style="font-weight: bold;">Rows: </span><span style="color: #0000BB;">769</span> <span style="font-weight: bold;">Columns: </span><span style="color: #0000BB;">46</span></span>
<span class="co">#&gt; <span style="color: #00BBBB;">──</span> <span style="font-weight: bold;">Column specification</span> <span style="color: #00BBBB;">────────────────────────────────────────────────────────</span></span>
<span class="co">#&gt; <span style="font-weight: bold;">Delimiter:</span> "\t"</span>
<span class="co">#&gt; <span style="color: #BB0000;">chr</span> (29): SpectrumID, Compound_Name, Ion_Source, Instrument, Compound_Source...</span>
<span class="co">#&gt; <span style="color: #00BB00;">dbl</span> (17): Precursor_MZ, ExactMass, Charge, Library_Class, #Scan#, MQScore, T...</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> Use <span style="color: #262626; background-color: #DADADA;">`spec()`</span> to retrieve the full column specification for this data.</span>
<span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> Specify the column types or set <span style="color: #262626; background-color: #DADADA;">`show_col_types = FALSE`</span> to quiet this message.</span>
<span class="co">#&gt; 2022-01-25 12:12:16 Exporting ... </span>
<span class="co">#&gt; 2022-01-25 12:12:16 ... path to export is inst/extdata/interim/annotations/96fa7c88200e4a03bee4644e581e3fb0_gnps_pretreated.tsv.gz </span>
<span class="co">#&gt; 2022-01-25 12:12:16 ... path to used parameters is inst/extdata/interim/config </span>
<span class="co">#&gt; 2022-01-25 12:12:16 Script finished in <span style="color: #00BB00;">1.022298 secs</span></span></code></pre></div>
<p>or</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/source.html" class="external-link">source</a></span><span class="op">(</span>file <span class="op">=</span> <span class="st">"inst/scripts/prepare_isdb.R"</span><span class="op">)</span>
<span class="co">#&gt; 2022-01-25 12:12:16 This script <span style="color: #00BB00;">formats ISDB results</span> </span>
<span class="co">#&gt; 2022-01-25 12:12:16 Authors:  <span style="color: #00BB00;">AR</span> </span>
<span class="co">#&gt;  </span>
<span class="co">#&gt; 2022-01-25 12:12:16 Contributors: ... </span>
<span class="co">#&gt; 2022-01-25 12:12:16 Loading paths </span>
<span class="co">#&gt; 2022-01-25 12:12:16 Loading yaml parameters </span>
<span class="co">#&gt; 2022-01-25 12:12:16 Loading command line arguments </span>
<span class="co">#&gt; 2022-01-25 12:12:16 Loading and formatting ISDB results</span>
<span class="co">#&gt; <span style="font-weight: bold;">Rows: </span><span style="color: #0000BB;">141495</span> <span style="font-weight: bold;">Columns: </span><span style="color: #0000BB;">7</span></span>
<span class="co">#&gt; <span style="color: #00BBBB;">──</span> <span style="font-weight: bold;">Column specification</span> <span style="color: #00BBBB;">────────────────────────────────────────────────────────</span></span>
<span class="co">#&gt; <span style="font-weight: bold;">Delimiter:</span> "\t"</span>
<span class="co">#&gt; <span style="color: #BB0000;">chr</span> (3): short_inchikey, smiles, molecular_formula</span>
<span class="co">#&gt; <span style="color: #00BB00;">dbl</span> (4): msms_score, matched_peaks, feature_id, exact_mass</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> Use <span style="color: #262626; background-color: #DADADA;">`spec()`</span> to retrieve the full column specification for this data.</span>
<span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> Specify the column types or set <span style="color: #262626; background-color: #DADADA;">`show_col_types = FALSE`</span> to quiet this message.</span>
<span class="co">#&gt; 2022-01-25 12:12:16 Exporting ... </span>
<span class="co">#&gt; 2022-01-25 12:12:16 ... path to export is inst/extdata/interim/annotations/96fa7c88200e4a03bee4644e581e3fb0_isdb_pretreated.tsv.gz </span>
<span class="co">#&gt; 2022-01-25 12:12:18 ... path to used parameters is inst/extdata/interim/config </span>
<span class="co">#&gt; 2022-01-25 12:12:18 Script finished in <span style="color: #00BB00;">1.467282 secs</span></span></code></pre></div>
<p>or</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/source.html" class="external-link">source</a></span><span class="op">(</span>file <span class="op">=</span> <span class="st">"inst/scripts/prepare_sirius.R"</span><span class="op">)</span>
<span class="co">#&gt; 2022-01-25 12:12:18 This script <span style="color: #00BB00;">formats SIRIUS results</span> </span>
<span class="co">#&gt; 2022-01-25 12:12:18 Authors:  <span style="color: #00BB00;">AR</span> </span>
<span class="co">#&gt;  </span>
<span class="co">#&gt; 2022-01-25 12:12:18 Contributors: ... </span>
<span class="co">#&gt; 2022-01-25 12:12:18 Loading paths </span>
<span class="co">#&gt; 2022-01-25 12:12:18 Loading yaml parameters </span>
<span class="co">#&gt; 2022-01-25 12:12:18 Loading command line arguments </span>
<span class="co">#&gt; 2022-01-25 12:12:18 Loading and formatting SIRIUS results</span>
<span class="co">#&gt; <span style="font-weight: bold;">Rows: </span><span style="color: #0000BB;">5563</span> <span style="font-weight: bold;">Columns: </span><span style="color: #0000BB;">10</span></span>
<span class="co">#&gt; <span style="color: #00BBBB;">──</span> <span style="font-weight: bold;">Column specification</span> <span style="color: #00BBBB;">────────────────────────────────────────────────────────</span></span>
<span class="co">#&gt; <span style="font-weight: bold;">Delimiter:</span> ","</span>
<span class="co">#&gt; <span style="color: #BB0000;">chr</span> (6): name, directoryName, pathway, superclass, class, ClassyFirePrediction</span>
<span class="co">#&gt; <span style="color: #00BB00;">dbl</span> (4): pathwayProbability, superclassProbability, classProbability, Classy...</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> Use <span style="color: #262626; background-color: #DADADA;">`spec()`</span> to retrieve the full column specification for this data.</span>
<span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> Specify the column types or set <span style="color: #262626; background-color: #DADADA;">`show_col_types = FALSE`</span> to quiet this message.</span>
<span class="co">#&gt; <span style="font-weight: bold;">Rows: </span><span style="color: #0000BB;">10408</span> <span style="font-weight: bold;">Columns: </span><span style="color: #0000BB;">10</span></span>
<span class="co">#&gt; <span style="color: #00BBBB;">──</span> <span style="font-weight: bold;">Column specification</span> <span style="color: #00BBBB;">────────────────────────────────────────────────────────</span></span>
<span class="co">#&gt; <span style="font-weight: bold;">Delimiter:</span> "\t"</span>
<span class="co">#&gt; <span style="color: #BB0000;">chr</span> (10): name, molecularFormula, adduct, precursorFormula, most specific cl...</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> Use <span style="color: #262626; background-color: #DADADA;">`spec()`</span> to retrieve the full column specification for this data.</span>
<span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> Specify the column types or set <span style="color: #262626; background-color: #DADADA;">`show_col_types = FALSE`</span> to quiet this message.</span>
<span class="co">#&gt; <span style="font-weight: bold;">Rows: </span><span style="color: #0000BB;">6514</span> <span style="font-weight: bold;">Columns: </span><span style="color: #0000BB;">16</span></span>
<span class="co">#&gt; <span style="color: #00BBBB;">──</span> <span style="font-weight: bold;">Column specification</span> <span style="color: #00BBBB;">────────────────────────────────────────────────────────</span></span>
<span class="co">#&gt; <span style="font-weight: bold;">Delimiter:</span> "\t"</span>
<span class="co">#&gt; <span style="color: #BB0000;">chr</span>  (4): molecularFormula, adduct, precursorFormula, id</span>
<span class="co">#&gt; <span style="color: #00BB00;">dbl</span> (11): rank, ZodiacScore, SiriusScore, TreeScore, IsotopeScore, numExplai...</span>
<span class="co">#&gt; <span style="color: #BBBB00;">lgl</span>  (1): retentionTimeInSeconds</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> Use <span style="color: #262626; background-color: #DADADA;">`spec()`</span> to retrieve the full column specification for this data.</span>
<span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> Specify the column types or set <span style="color: #262626; background-color: #DADADA;">`show_col_types = FALSE`</span> to quiet this message.</span>
<span class="co">#&gt; <span style="font-weight: bold;">Rows: </span><span style="color: #0000BB;">8533</span> <span style="font-weight: bold;">Columns: </span><span style="color: #0000BB;">16</span></span>
<span class="co">#&gt; <span style="color: #00BBBB;">──</span> <span style="font-weight: bold;">Column specification</span> <span style="color: #00BBBB;">────────────────────────────────────────────────────────</span></span>
<span class="co">#&gt; <span style="font-weight: bold;">Delimiter:</span> "\t"</span>
<span class="co">#&gt; <span style="color: #BB0000;">chr</span>  (4): molecularFormula, adduct, precursorFormula, id</span>
<span class="co">#&gt; <span style="color: #00BB00;">dbl</span> (11): rank, ZodiacScore, SiriusScore, TreeScore, IsotopeScore, numExplai...</span>
<span class="co">#&gt; <span style="color: #BBBB00;">lgl</span>  (1): retentionTimeInSeconds</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> Use <span style="color: #262626; background-color: #DADADA;">`spec()`</span> to retrieve the full column specification for this data.</span>
<span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> Specify the column types or set <span style="color: #262626; background-color: #DADADA;">`show_col_types = FALSE`</span> to quiet this message.</span>
<span class="co">#&gt; <span style="font-weight: bold;">Rows: </span><span style="color: #0000BB;">5735</span> <span style="font-weight: bold;">Columns: </span><span style="color: #0000BB;">21</span></span>
<span class="co">#&gt; <span style="color: #00BBBB;">──</span> <span style="font-weight: bold;">Column specification</span> <span style="color: #00BBBB;">────────────────────────────────────────────────────────</span></span>
<span class="co">#&gt; <span style="font-weight: bold;">Delimiter:</span> "\t"</span>
<span class="co">#&gt; <span style="color: #BB0000;">chr</span> (10): ConfidenceScore, molecularFormula, adduct, InChIkey2D, InChI, name...</span>
<span class="co">#&gt; <span style="color: #00BB00;">dbl</span> (10): rank, formulaRank, #adducts, #predictedFPs, CSI:FingerIDScore, Zod...</span>
<span class="co">#&gt; <span style="color: #BBBB00;">lgl</span>  (1): retentionTimeInSeconds</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> Use <span style="color: #262626; background-color: #DADADA;">`spec()`</span> to retrieve the full column specification for this data.</span>
<span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> Specify the column types or set <span style="color: #262626; background-color: #DADADA;">`show_col_types = FALSE`</span> to quiet this message.</span>
<span class="co">#&gt; <span style="font-weight: bold;">Rows: </span><span style="color: #0000BB;">8256</span> <span style="font-weight: bold;">Columns: </span><span style="color: #0000BB;">21</span></span>
<span class="co">#&gt; <span style="color: #00BBBB;">──</span> <span style="font-weight: bold;">Column specification</span> <span style="color: #00BBBB;">────────────────────────────────────────────────────────</span></span>
<span class="co">#&gt; <span style="font-weight: bold;">Delimiter:</span> "\t"</span>
<span class="co">#&gt; <span style="color: #BB0000;">chr</span> (10): ConfidenceScore, molecularFormula, adduct, InChIkey2D, InChI, name...</span>
<span class="co">#&gt; <span style="color: #00BB00;">dbl</span> (10): rank, formulaRank, #adducts, #predictedFPs, CSI:FingerIDScore, Zod...</span>
<span class="co">#&gt; <span style="color: #BBBB00;">lgl</span>  (1): retentionTimeInSeconds</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> Use <span style="color: #262626; background-color: #DADADA;">`spec()`</span> to retrieve the full column specification for this data.</span>
<span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> Specify the column types or set <span style="color: #262626; background-color: #DADADA;">`show_col_types = FALSE`</span> to quiet this message.</span>
<span class="co">#&gt; Joining, by = c("feature_id", "molecular_formula")</span>
<span class="co">#&gt; Joining, by = "feature_id"</span>
<span class="co">#&gt; Warning: 3523 features have no exact mass. This is somehow unexpected and under investigation.2022-01-25 12:12:19 Sirius weighting is still not optimal given the input candidate list ... </span>
<span class="co">#&gt; 2022-01-25 12:12:19 See https://github.com/boecker-lab/sirius/issues/50 for more info... </span>
<span class="co">#&gt; 2022-01-25 12:12:19 Exporting ... </span>
<span class="co">#&gt; 2022-01-25 12:12:19 ... path to export is inst/extdata/interim/annotations/96fa7c88200e4a03bee4644e581e3fb0_sirius_pretreated.tsv.gz </span>
<span class="co">#&gt; 2022-01-25 12:12:19 ... path to used parameters is inst/extdata/interim/config </span>
<span class="co">#&gt; 2022-01-25 12:12:19 Script finished in <span style="color: #00BB00;">0.9660227 secs</span></span></code></pre></div>
<p>You now have your annotations well prepared and can keep on formatting the rest of your metadata</p>
</div>
</div>
<div class="section level2">
<h2 id="chemical-class-annotation-of-your-features">Chemical class annotation of your features<a class="anchor" aria-label="anchor" href="#chemical-class-annotation-of-your-features"></a>
</h2>
<p>Within our workflow, we offer a new way to attribute chemical classes to your features. It is analog to <a href="https://ccms-ucsd.github.io/GNPSDocumentation/nap/" class="external-link">Network Annotation Propagation</a>, but uses the edges of your network instead of the clusters. This makes more sense in our view, as also recently illustrated by <a href="https://doi.org/10.1038/s41587-020-0740-8" class="external-link">CANOPUS</a>.</p>
<p>All steps can take both manual inputs or GNPS metadata directly from your GNPS job ID.</p>
<p>We are currently also working on CANOPUS integration for chemical class annotation but this implies way heavier computations and we want to offer our users a <strong>fast</strong> solution.</p>
<div class="section level3">
<h3 id="formatting-1">Formatting<a class="anchor" aria-label="anchor" href="#formatting-1"></a>
</h3>
<p>Before running the corresponding code, do not forget to modify <code>config/params/prepare_edges.yaml</code>, <code>config/params/prepare_features_components.yaml</code>, and <code>config/params/prepare_features_classification.yaml</code> accordingly.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/source.html" class="external-link">source</a></span><span class="op">(</span>file <span class="op">=</span> <span class="st">"inst/scripts/prepare_edges.R"</span><span class="op">)</span>
<span class="co">#&gt; 2022-01-25 12:12:19 This script <span style="color: #00BB00;">prepares edges</span> </span>
<span class="co">#&gt; 2022-01-25 12:12:19 Authors:  <span style="color: #00BB00;">AR</span> </span>
<span class="co">#&gt;  </span>
<span class="co">#&gt; 2022-01-25 12:12:19 Contributors: ... </span>
<span class="co">#&gt; 2022-01-25 12:12:19 Loading paths </span>
<span class="co">#&gt; 2022-01-25 12:12:19 Loading yaml parameters </span>
<span class="co">#&gt; 2022-01-25 12:12:19 Loading command line arguments </span>
<span class="co">#&gt; 2022-01-25 12:12:19 Loading edge table</span>
<span class="co">#&gt; <span style="font-weight: bold;">Rows: </span><span style="color: #0000BB;">14453</span> <span style="font-weight: bold;">Columns: </span><span style="color: #0000BB;">8</span></span>
<span class="co">#&gt; <span style="color: #00BBBB;">──</span> <span style="font-weight: bold;">Column specification</span> <span style="color: #00BBBB;">────────────────────────────────────────────────────────</span></span>
<span class="co">#&gt; <span style="font-weight: bold;">Delimiter:</span> "\t"</span>
<span class="co">#&gt; <span style="color: #BB0000;">chr</span> (1): EdgeAnnotation</span>
<span class="co">#&gt; <span style="color: #00BB00;">dbl</span> (7): CLUSTERID1, CLUSTERID2, DeltaMZ, MEH, Cosine, OtherScore, Component...</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> Use <span style="color: #262626; background-color: #DADADA;">`spec()`</span> to retrieve the full column specification for this data.</span>
<span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> Specify the column types or set <span style="color: #262626; background-color: #DADADA;">`show_col_types = FALSE`</span> to quiet this message.</span>
<span class="co">#&gt; 2022-01-25 12:12:20 Formatting edge table </span>
<span class="co">#&gt; 2022-01-25 12:12:20 Exporting ... </span>
<span class="co">#&gt; 2022-01-25 12:12:20 ... path to export is inst/extdata/interim/edges/96fa7c88200e4a03bee4644e581e3fb0_edges.tsv.gz </span>
<span class="co">#&gt; 2022-01-25 12:12:20 ... path to used parameters is inst/extdata/interim/config </span>
<span class="co">#&gt; 2022-01-25 12:12:20 Script finished in <span style="color: #00BB00;">0.7690663 secs</span></span>
<span class="kw"><a href="https://rdrr.io/r/base/source.html" class="external-link">source</a></span><span class="op">(</span>file <span class="op">=</span> <span class="st">"inst/scripts/prepare_features_components.R"</span><span class="op">)</span>
<span class="co">#&gt; 2022-01-25 12:12:20 This script <span style="color: #00BB00;">prepares features metadata (mz, rt and component id)</span> </span>
<span class="co">#&gt; 2022-01-25 12:12:20 Authors:  <span style="color: #00BB00;">AR</span> </span>
<span class="co">#&gt;  </span>
<span class="co">#&gt; 2022-01-25 12:12:20 Contributors: ... </span>
<span class="co">#&gt; 2022-01-25 12:12:20 Loading paths </span>
<span class="co">#&gt; 2022-01-25 12:12:20 Loading yaml parameters </span>
<span class="co">#&gt; 2022-01-25 12:12:20 Loading command line arguments </span>
<span class="co">#&gt; 2022-01-25 12:12:20 Loading files ... </span>
<span class="co">#&gt; 2022-01-25 12:12:20 ... features table</span>
<span class="co">#&gt; <span style="font-weight: bold;">Rows: </span><span style="color: #0000BB;">141495</span> <span style="font-weight: bold;">Columns: </span><span style="color: #0000BB;">12</span></span>
<span class="co">#&gt; <span style="color: #00BBBB;">──</span> <span style="font-weight: bold;">Column specification</span> <span style="color: #00BBBB;">────────────────────────────────────────────────────────</span></span>
<span class="co">#&gt; <span style="font-weight: bold;">Delimiter:</span> "\t"</span>
<span class="co">#&gt; <span style="color: #BB0000;">chr</span> (5): smiles, molecular_formula, inchikey_2D, library, smiles_2D</span>
<span class="co">#&gt; <span style="color: #00BB00;">dbl</span> (3): feature_id, structure_exact_mass, score_input</span>
<span class="co">#&gt; <span style="color: #BBBB00;">lgl</span> (4): inchikey, structure_taxonomy_npclassifier_01pathway, structure_taxo...</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> Use <span style="color: #262626; background-color: #DADADA;">`spec()`</span> to retrieve the full column specification for this data.</span>
<span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> Specify the column types or set <span style="color: #262626; background-color: #DADADA;">`show_col_types = FALSE`</span> to quiet this message.</span>
<span class="co">#&gt; 2022-01-25 12:12:20 ... cluster table </span>
<span class="co">#&gt; 2022-01-25 12:12:20 THIS STEP CAN BE IMPROVED BY CALCULATING THE CLUSTERS WITHIN SPEC2VEC</span>
<span class="co">#&gt; <span style="font-weight: bold;">Rows: </span><span style="color: #0000BB;">7897</span> <span style="font-weight: bold;">Columns: </span><span style="color: #0000BB;">32</span></span>
<span class="co">#&gt; <span style="color: #00BBBB;">──</span> <span style="font-weight: bold;">Column specification</span> <span style="color: #00BBBB;">────────────────────────────────────────────────────────</span></span>
<span class="co">#&gt; <span style="font-weight: bold;">Delimiter:</span> "\t"</span>
<span class="co">#&gt; <span style="color: #BB0000;">chr</span>  (8): ATTRIBUTE_species, GNPSLinkout_Cluster, GNPSLinkout_Network, INCHI...</span>
<span class="co">#&gt; <span style="color: #00BB00;">dbl</span> (24): G1, G2, G3, G4, G5, G6, GNPSGROUP:Arnica montana, GNPSGROUP:BLK, G...</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> Use <span style="color: #262626; background-color: #DADADA;">`spec()`</span> to retrieve the full column specification for this data.</span>
<span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> Specify the column types or set <span style="color: #262626; background-color: #DADADA;">`show_col_types = FALSE`</span> to quiet this message.</span>
<span class="co">#&gt; 2022-01-25 12:12:22 Adding components to features</span>
<span class="co">#&gt; Joining, by = "feature_id"</span>
<span class="co">#&gt; 2022-01-25 12:12:22 Calculating mz error </span>
<span class="co">#&gt; 2022-01-25 12:12:22 Exporting ... </span>
<span class="co">#&gt; 2022-01-25 12:12:22 ... path to export is inst/extdata/interim/annotations/96fa7c88200e4a03bee4644e581e3fb0_isdb_filled.tsv.gz </span>
<span class="co">#&gt; 2022-01-25 12:12:23 ... path to used parameters is inst/extdata/interim/config </span>
<span class="co">#&gt; 2022-01-25 12:12:23 Script finished in <span style="color: #00BB00;">3.546255 secs</span></span>
<span class="kw"><a href="https://rdrr.io/r/base/source.html" class="external-link">source</a></span><span class="op">(</span>file <span class="op">=</span> <span class="st">"inst/scripts/prepare_features_classification.R"</span><span class="op">)</span>
<span class="co">#&gt; 2022-01-25 12:12:23 This script <span style="color: #00BB00;">prepares features metadata (chemical classes)</span> </span>
<span class="co">#&gt; 2022-01-25 12:12:23 Authors:  <span style="color: #00BB00;">AR</span> </span>
<span class="co">#&gt;  </span>
<span class="co">#&gt; 2022-01-25 12:12:23 Contributors: ... </span>
<span class="co">#&gt; 2022-01-25 12:12:23 Loading paths </span>
<span class="co">#&gt; 2022-01-25 12:12:23 Loading yaml parameters </span>
<span class="co">#&gt; 2022-01-25 12:12:23 Loading command line arguments </span>
<span class="co">#&gt; 2022-01-25 12:12:23 Loading files ... </span>
<span class="co">#&gt; 2022-01-25 12:12:23 ... library</span>
<span class="co">#&gt; <span style="font-weight: bold;">Rows: </span><span style="color: #0000BB;">611142</span> <span style="font-weight: bold;">Columns: </span><span style="color: #0000BB;">7</span></span>
<span class="co">#&gt; <span style="color: #00BBBB;">──</span> <span style="font-weight: bold;">Column specification</span> <span style="color: #00BBBB;">────────────────────────────────────────────────────────</span></span>
<span class="co">#&gt; <span style="font-weight: bold;">Delimiter:</span> "\t"</span>
<span class="co">#&gt; <span style="color: #BB0000;">chr</span> (6): structure_inchikey_2D, structure_smiles_2D, structure_molecular_for...</span>
<span class="co">#&gt; <span style="color: #00BB00;">dbl</span> (1): structure_exact_mass</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> Use <span style="color: #262626; background-color: #DADADA;">`spec()`</span> to retrieve the full column specification for this data.</span>
<span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> Specify the column types or set <span style="color: #262626; background-color: #DADADA;">`show_col_types = FALSE`</span> to quiet this message.</span>
<span class="co">#&gt; 2022-01-25 12:12:25 ... features table</span>
<span class="co">#&gt; <span style="font-weight: bold;">Rows: </span><span style="color: #0000BB;">146988</span> <span style="font-weight: bold;">Columns: </span><span style="color: #0000BB;">14</span></span>
<span class="co">#&gt; <span style="color: #00BBBB;">──</span> <span style="font-weight: bold;">Column specification</span> <span style="color: #00BBBB;">────────────────────────────────────────────────────────</span></span>
<span class="co">#&gt; <span style="font-weight: bold;">Delimiter:</span> "\t"</span>
<span class="co">#&gt; <span style="color: #BB0000;">chr</span> (4): inchikey_2D, smiles_2D, molecular_formula, library</span>
<span class="co">#&gt; <span style="color: #00BB00;">dbl</span> (7): feature_id, component_id, rt, mz, structure_exact_mass, score_input...</span>
<span class="co">#&gt; <span style="color: #BBBB00;">lgl</span> (3): structure_taxonomy_npclassifier_01pathway, structure_taxonomy_npcla...</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> Use <span style="color: #262626; background-color: #DADADA;">`spec()`</span> to retrieve the full column specification for this data.</span>
<span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> Specify the column types or set <span style="color: #262626; background-color: #DADADA;">`show_col_types = FALSE`</span> to quiet this message.</span>
<span class="co">#&gt; 2022-01-25 12:12:25 Filtering structures ... </span>
<span class="co">#&gt; 2022-01-25 12:12:25 ... missing classification </span>
<span class="co">#&gt; 2022-01-25 12:12:26 ... missing masses </span>
<span class="co">#&gt; 2022-01-25 12:12:26 ... missing formulas </span>
<span class="co">#&gt; 2022-01-25 12:12:26 ... keeping the other ones safe</span>
<span class="co">#&gt; Joining, by = c("inchikey_2D", "smiles_2D")</span>
<span class="co">#&gt; Joining, by = c("inchikey_2D", "smiles_2D")</span>
<span class="co">#&gt; Joining, by = c("inchikey_2D", "smiles_2D")</span>
<span class="co">#&gt; 2022-01-25 12:12:26 Completing the structures with the library</span>
<span class="co">#&gt; Joining, by = c("inchikey_2D", "smiles_2D")</span>
<span class="co">#&gt; Joining, by = c("inchikey_2D", "smiles_2D")</span>
<span class="co">#&gt; Joining, by = c("inchikey_2D", "smiles_2D")</span>
<span class="co">#&gt; 2022-01-25 12:12:26 Filtering structures again (to calculate this time) ...</span>
<span class="co">#&gt; Joining, by = c("inchikey_2D", "smiles_2D", "structure_taxonomy_npclassifier_01pathway", "structure_taxonomy_npclassifier_02superclass", "structure_taxonomy_npclassifier_03class")</span>
<span class="co">#&gt; Joining, by = c("inchikey_2D", "smiles_2D", "structure_exact_mass")</span>
<span class="co">#&gt; Joining, by = c("inchikey_2D", "smiles_2D", "molecular_formula")</span>
<span class="co">#&gt; 2022-01-25 12:12:26 Calculation is not performed yet (TODO) ... </span>
<span class="co">#&gt; 2022-01-25 12:12:26 Recombining everything back together</span>
<span class="co">#&gt; Joining, by = c("inchikey_2D", "smiles_2D")</span>
<span class="co">#&gt; Joining, by = c("inchikey_2D", "smiles_2D")</span>
<span class="co">#&gt; Joining, by = c("inchikey_2D", "smiles_2D")</span>
<span class="co">#&gt; 2022-01-25 12:12:28 Exporting ... </span>
<span class="co">#&gt; 2022-01-25 12:12:28 ... path to export is inst/extdata/interim/annotations/96fa7c88200e4a03bee4644e581e3fb0_isdb_treated.tsv.gz </span>
<span class="co">#&gt; 2022-01-25 12:12:29 ... path to used parameters is inst/extdata/interim/config </span>
<span class="co">#&gt; 2022-01-25 12:12:29 Script finished in <span style="color: #00BB00;">5.827875 secs</span></span></code></pre></div>
<p>Your features are now not only informed with structural information but also, chemical class information. The latter might be corresponding <strong>or not</strong> to the chemical class of your annotated structure, depending on the consistency of your annotations.</p>
</div>
</div>
<div class="section level2">
<h2 id="biological-source-annotation">Biological source annotation<a class="anchor" aria-label="anchor" href="#biological-source-annotation"></a>
</h2>
<p>This step allows you to attribute biological source information to your features. If all your features come from a single extract, it will attribute the biological source of your extract to all your features. If you have multiple extracts aligned, it will take the <em>n</em> (according to your parameters) highest intensities of your aligned feature table and attribute the biological source of corresponding extracts. It can take both manual inputs or GNPS metadata directly from your GNPS job ID.</p>
<p>Before running the corresponding code, do not forget to modify <code>config/params/prepare_taxa.yaml</code>.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/source.html" class="external-link">source</a></span><span class="op">(</span>file <span class="op">=</span> <span class="st">"inst/scripts/prepare_taxa.R"</span><span class="op">)</span>
<span class="co">#&gt; 2022-01-25 12:12:29 This script <span style="color: #00BB00;">informs taxonomically features</span> </span>
<span class="co">#&gt; 2022-01-25 12:12:29 Authors:  <span style="color: #00BB00;">AR</span> , <span style="color: #0000BB;">PMA</span> </span>
<span class="co">#&gt;  </span>
<span class="co">#&gt; 2022-01-25 12:12:29 Contributors: ... </span>
<span class="co">#&gt; 2022-01-25 12:12:29 Loading paths </span>
<span class="co">#&gt; 2022-01-25 12:12:29 Loading yaml parameters </span>
<span class="co">#&gt; 2022-01-25 12:12:29 Loading command line arguments </span>
<span class="co">#&gt; 2022-01-25 12:12:29 Loading taxa ranks dictionary</span>
<span class="co">#&gt; <span style="font-weight: bold;">Rows: </span><span style="color: #0000BB;">17</span> <span style="font-weight: bold;">Columns: </span><span style="color: #0000BB;">2</span></span>
<span class="co">#&gt; <span style="color: #00BBBB;">──</span> <span style="font-weight: bold;">Column specification</span> <span style="color: #00BBBB;">────────────────────────────────────────────────────────</span></span>
<span class="co">#&gt; <span style="font-weight: bold;">Delimiter:</span> "\t"</span>
<span class="co">#&gt; <span style="color: #BB0000;">chr</span> (2): taxaRank, taxaRankStandard</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> Use <span style="color: #262626; background-color: #DADADA;">`spec()`</span> to retrieve the full column specification for this data.</span>
<span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> Specify the column types or set <span style="color: #262626; background-color: #DADADA;">`show_col_types = FALSE`</span> to quiet this message.</span>
<span class="co">#&gt; 2022-01-25 12:12:29 Loading feature table</span>
<span class="co">#&gt; <span style="font-weight: bold;">Rows: </span><span style="color: #0000BB;">7897</span> <span style="font-weight: bold;">Columns: </span><span style="color: #0000BB;">9</span></span>
<span class="co">#&gt; <span style="color: #00BBBB;">──</span> <span style="font-weight: bold;">Column specification</span> <span style="color: #00BBBB;">────────────────────────────────────────────────────────</span></span>
<span class="co">#&gt; <span style="font-weight: bold;">Delimiter:</span> ","</span>
<span class="co">#&gt; <span style="color: #00BB00;">dbl</span> (9): row ID, row m/z, row retention time, 0_AR_Blk_C18_Pos.mzML Peak are...</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> Use <span style="color: #262626; background-color: #DADADA;">`spec()`</span> to retrieve the full column specification for this data.</span>
<span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> Specify the column types or set <span style="color: #262626; background-color: #DADADA;">`show_col_types = FALSE`</span> to quiet this message.</span>
<span class="co">#&gt; 2022-01-25 12:12:30 Loading metadata table</span>
<span class="co">#&gt; <span style="font-weight: bold;">Rows: </span><span style="color: #0000BB;">6</span> <span style="font-weight: bold;">Columns: </span><span style="color: #0000BB;">2</span></span>
<span class="co">#&gt; <span style="color: #00BBBB;">──</span> <span style="font-weight: bold;">Column specification</span> <span style="color: #00BBBB;">────────────────────────────────────────────────────────</span></span>
<span class="co">#&gt; <span style="font-weight: bold;">Delimiter:</span> "\t"</span>
<span class="co">#&gt; <span style="color: #BB0000;">chr</span> (2): filename, ATTRIBUTE_species</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> Use <span style="color: #262626; background-color: #DADADA;">`spec()`</span> to retrieve the full column specification for this data.</span>
<span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> Specify the column types or set <span style="color: #262626; background-color: #DADADA;">`show_col_types = FALSE`</span> to quiet this message.</span>
<span class="co">#&gt; 2022-01-25 12:12:30 Formatting feature table ... </span>
<span class="co">#&gt; 2022-01-25 12:12:30 ... WARNING: requires 'Peak area' in columns (MZmine format) </span>
<span class="co">#&gt; 2022-01-25 12:12:30 ... filtering top K intensities per feature </span>
<span class="co">#&gt; 2022-01-25 12:12:31 Keeping list of organisms to submit to OTL</span>
<span class="co">#&gt; Warning in type.convert.default(unlist(x, use.names = FALSE)): 'as.is' should be</span>
<span class="co">#&gt; specified by the caller; using TRUE</span>
<span class="co">#&gt; Warning: BLK are not matched</span>
<span class="co">#&gt; Joining, by = "search_string"</span>
<span class="co">#&gt; 2022-01-25 12:12:32 Joining top K with metadata table </span>
<span class="co">#&gt; 2022-01-25 12:12:32 Joining with cleaned taxonomy table </span>
<span class="co">#&gt; 2022-01-25 12:12:34 joining with cleaned taxonomy table </span>
<span class="co">#&gt; 2022-01-25 12:12:34 Exporting ... </span>
<span class="co">#&gt; 2022-01-25 12:12:34 ... path to export is inst/extdata/interim/taxa/96fa7c88200e4a03bee4644e581e3fb0_taxed.tsv.gz </span>
<span class="co">#&gt; 2022-01-25 12:12:34 ... path to used parameters is inst/extdata/interim/config </span>
<span class="co">#&gt; 2022-01-25 12:12:34 Script finished in <span style="color: #00BB00;">4.784098 secs</span></span></code></pre></div>
<p>We now recommend you to read the <a href="https://taxonomicallyinformedannotation.github.io/tima-r/articles/3-processing.html">next vignette</a>.</p>
</div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p></p>
<p>Developed by Adriano Rutz.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.2.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
